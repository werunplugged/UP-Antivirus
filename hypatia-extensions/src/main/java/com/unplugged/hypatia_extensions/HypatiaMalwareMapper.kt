package com.unplugged.hypatia_extensions

import com.unplugged.upantiviruscommon.malware.MalwareModel
import com.unplugged.upantiviruscommon.malware.ScanStats
import com.unplugged.upantiviruscommon.malware.ThreatStatus
import com.unplugged.upantiviruscommon.model.ScannerType


class HypatiaMalwareMapper {
    fun convertMalwareModel(malwareModel: us.spotco.malwarescanner.malware.MalwareModel): MalwareModel {
        return MalwareModel(
            malwareModel.id,
            malwareModel.scanId,
            malwareModel.name,
            malwareModel.description,
            malwareModel.filePath,
            convertThreatStatus(malwareModel.status)
        )
    }

    private fun convertThreatStatus(threatStatus: us.spotco.malwarescanner.malware.ThreatStatus): ThreatStatus {
        return ThreatStatus.valueOf(threatStatus.name)
    }

    fun convertScanStats(stats: us.spotco.malwarescanner.malware.ScanStats): ScanStats {
        return ScanStats(
            stats.secondsSpent,
            stats.megabytesHashed,
            stats.totalFilesScanned,
            stats.historyItemId,
            stats.isCanceled,
            ScannerType.HYPATIA
        )
    }

}